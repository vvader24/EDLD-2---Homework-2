---
title: "Homework 2"
author: "Raleigh Goodwin, Kavya Mudiam, Vinita Vader, Zach Shroeder, Ann-Marie Barrett"
"
date: "2/27/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
library(dplyr)
library(colorspace)
library(ggplot2)
library(here)
library(janitor)
library(lubridate)
library(rio)

transit_cost <- read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-01-05/transit_cost.csv')

#install.packages("tidytuesdayR")
#transit_cost <- tidytuesdayR::tt_load(2021, week = 2)
crime = import(here("Data/crime.csv"), setclass = "tb_df") %>% 
  characterize() %>% 
  clean_names()

#install.packages("countrycode")
country_codes <- countrycode::codelist %>% 
  select(country_name = country.name.en, country = ecb)
```

# Question 1
```{r}
transit_cost <- left_join(transit_cost, country_codes, by = "country")

transit_cost_by_c <- transit_cost %>% 
  select(country_name, real_cost) %>% 
  drop_na() %>% 
  mutate(country_name = factor(country_name),
         real_cost = as.numeric(real_cost)) %>%
  drop_na() %>% 
  group_by(country_name) %>% 
  summarize(mean_cost = mean(real_cost),
            se_cost = sd(real_cost)/sqrt(n())) %>% 
  arrange(desc(mean_cost))

transit_cost_by_c %>%
  mutate(country_name = fct_reorder(country_name, mean_cost)) %>% 
ggplot(aes(country_name, mean_cost)) +
geom_errorbar(aes(ymin = mean_cost + qnorm(0.025)*se_cost,
ymax = mean_cost + qnorm(0.975)*se_cost)) +
geom_point(color = "cornflower blue") +
coord_flip()+
  theme_minimal()+
  labs(x = "Country",
       y = "Real Cost (In millions of dollars)",
       title = "Cost to build transit systems vary across countries",
       caption = "Data provided through #tidytuesday by the Transit Costs Project")
```


#Question 2
```{r}
p<- transit_cost_by_c %>%
  mutate(country_name = fct_reorder(country_name, mean_cost)) %>% 
ggplot(aes(country_name, mean_cost)) +
geom_errorbar(aes(ymin = mean_cost + qnorm(0.025)*se_cost,
ymax = mean_cost + qnorm(0.975)*se_cost,
color = "95%"),
width = 0.2,
                size = 0.4) + 
  geom_errorbar(aes(ymin = mean_cost + qnorm(0.05)*se_cost,
                    ymax = mean_cost + qnorm(0.95)*se_cost,
                    color = "90%"),
                width = 0.2,
                size = 0.6) + 
  geom_errorbar(aes(ymin = mean_cost + qnorm(0.1)*se_cost,
                    ymax = mean_cost + qnorm(0.9)*se_cost,
                    color = "80%"),
                width = 0.2,
                size = 0.8)

p + scale_color_manual("Confidence Interval",
                     values = c("#4375D3",
                                lighten("#4375D3", .3),
                                lighten("#4375D3", .6))) +
  geom_point(size = 0.6) +
  coord_flip() 

```